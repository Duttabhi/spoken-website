{% extends 'spoken/templates/base.html' %}
{% load widget_tweaks %}
{% load static %}
{% load eventsdata %}
{% block title %}Upload Tutorial{% endblock %}
{% block cssblock %}<link rel="stylesheet" href="{% static 'spoken/css/chosen.min.css' %}" type="text/css" media="screen" charset="utf-8" />{% endblock %}
{% if alert_success or alert_danger %}
	{% block alert %}
		{% if alert_success %}
			<div class="alert alert-success alert-dismissable">
				<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
				{{ alert_success }}
			</div>
		{% endif %}
		{% if alert_danger %}
			<div class="alert alert-danger alert-dismissable">
				<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
				{{ alert_danger }}
			</div>
		{% endif %}
	{% endblock %}
{% endif %}
{% block content %}
	<!-- Nav tabs -->
	<ul class="tabs nav nav-tabs">
		<li><a href="/events/test/request/">New</a></li>
		<li {% if status == 'pending' %}{{ 'class="active"'}}{% endif %}><a href="/events/test/{{role}}/pending/">Pending</a></li>
		<li {% if status == 'waitingforinvigilator' %}{{ 'class="active"'}}{% endif %}><a href="/events/test/{{role}}/waitingforinvigilator/">Waiting for Invigilator</a></li>
		<li {% if status == 'approved' %}{{ 'class="active"'}}{% endif %}><a href="/events/test/{{role}}/approved/">Approved</a></li>
		<li {% if status == 'ongoing' %}{{ 'class="active"'}}{% endif %}><a href="/events/test/{{role}}/ongoing/">Ongoing</a></li>
		<li {% if status == 'completed' %}{{ 'class="active"'}}{% endif %}><a href="/events/test/{{role}}/completed/">Completed</a></li>
		<li {% if status == 'reschedule' %}{{ 'class="active"'}}{% endif %}><a href="/events/test/{{role}}/reschedule/">Reschedule</a></li>
		<li {% if status == 'rejected' %}{{ 'class="active"'}}{% endif %}><a href="/events/test/{{role}}/rejected/">Rejected</a></li>
	</ul>
	<!-- Tab panes -->
	<div class="tab-content">
		<div class="tab-pane" id="new">
			<iframe width = "100%" src="/events/test/request/"></iframe> -->
		</div>
		<div class="tab-pane active" id="pending">
			{% if collection %}
			<table class="table table-striped table-hover table-bordered">
				<tr>
					<th>Academic Name</th>
					<th>FOSS</th>
					<th>Date </th>
					<th>Action</th>
				</tr>
				{% for record in collection %}
					<tr>
						<td>{{ record.academic }}</td>
						<td>{{ record.foss }}</td>
						<td>{{ record.tdate|date:"d M Y" }} {{	record.ttime }}</td>
						<!-- actions based on roles -->
						<td>
						{% if status == 'completed' %}
						    <a href="{% url 'events:test_participant' record.id %}">View Participant</a>
						{% endif %}
						{% if role == 'rp' %}
						    {% if status == 'pending' or status == 'approved' %}
							    <a href="{% url 'events:test_edit' record.id %}">Edit</a>
							{% endif %}
						{% endif %}
						
						{% if role == 'organiser' %}
						    {% if status == 'pending' or status == 'approved' %}
							    <a href="{% url 'events:test_edit' record.id %}">Edit</a>
							{% endif %}
						{% endif %}
						
						{% if role == 'invigilator' %}
						    {% if status == 'waitingforinvigilator' %}
							    <a href="{% url 'events:test_approvel' record.id %}?status=invigilatoraccept">Accept</a>
							    <a href="{% url 'events:test_approvel' record.id %}?status=invigilatorreject">Reject</a>
							{% endif %}
							{% if status == 'approved' and todaytest %}
							    <a href="{% url 'events:test_attendance' record.id %}">Attendance</a>
							{% endif %}
							{% if status == 'ongoing' %}
							    <a href="{% url 'events:test_attendance' record.id %}">Attendance</a> |
							    {% with a=record.id|can_close_test %}
							        {% if a %}
							            <a title = "button will enable after student completed the test" href="{% url 'events:test_approvel' record.id %}?status=completed">Close</a>
							        {% else %}
							            <a title = "On going" href="">test ongoing</a>
							        {% endif %}
							    {% endwith %}
							{% endif %}
						{% endif %}
						
						</td>
					</tr>
				{% endfor %}
			</table>
			{% else %}
				<p>No record found!</p>
			{% endif %}
		</div>
	</div>
{% endblock %}
