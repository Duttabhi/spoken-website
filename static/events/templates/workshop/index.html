{% extends 'spoken/templates/base.html' %}
{% load widget_tweaks %}
{% load static %}
{% load cmsdata %}
{% load creationdata %}
{% load eventsdata %}
{% block title %}Workshop - {{ status}} {% endblock %}
{% block cssblock %}<link rel="stylesheet" href="{% static 'spoken/css/chosen.min.css' %}" type="text/css" media="screen" charset="utf-8" />{% endblock %}
{% block heading %}
        <i class="fa fa-list-ul"></i> Workshop <a href="{% url 'events:events_dashboard' %}" class='pull-right'>Dashboard</a>
{% endblock %}
{% block content %}
    <div class= 'filters' >
        <form action="" method="get" class='form-horizontal'>
            <div class="form-group">
                <label for="id_state" class="col-sm-2 control-label">State</label>
                <div class="col-sm-10">
                    {% render_field form.academic__state class+="form-control chosen academic_state" tabindex="1" %}
                    {{ form.academic__state.errors }}
                </div>
            </div>
            <div class="form-group">
                <label for="id_state" class="col-sm-2 control-label">Foss</label>
                <div class="col-sm-10">
                    {% render_field form.foss class+="form-control chosen foss" tabindex="1" %}
                    {{ form.foss.errors }}
                </div>
            </div>
            <div class="form-group">
                <label for="id_state" class="col-sm-2 control-label">Workshop Type</label>
                <div class="col-sm-10">
                    {% render_field form.workshop_type class+="form-control chosen workshop_type" tabindex="1" %}
                    {{ form.workshop_type.errors }}
                </div>
            </div>
            <div class="form-group">
              <div class="col-sm-offset-2 col-sm-10">
                 <input class="btn btn-success" type="submit" value="Filter" />
                 <a class="btn btn-success" href="{{request.path}}?{{ request.GET|reset_get_values}}">Reset Filter</a>
              </div>
           </div>
        </form>
    </div>
	<!-- Nav tabs -->
	<ul class="tabs nav nav-tabs">
	    {% if role == 'organiser' %}
		    <li><a href="/software-training/workshop/{{ role }}/request/">New</a></li>
		    <li {% if status == 'pending' %}{{ 'class="active"'}}{% endif %}><a href="/software-training/workshop/{{role}}/pending/">Pending</a></li>
		{% endif %}
		{% if role == 'rp' %}
		    <li {% if status == 'pending' %}{{ 'class="active"'}}{% endif %}><a href="/software-training/workshop/{{role}}/pending/">New Requests</a></li>
		{% endif %}
        <li {% if status == 'ongoing' %}{{ 'class="active"'}}{% endif %}><a href="/software-training/workshop/{{role}}/ongoing/">Ongoing</a></li>
        <li {% if status == 'approved' %}{{ 'class="active"'}}{% endif %}><a href="/software-training/workshop/{{role}}/approved/">Approved</a></li>
        <li {% if status == 'completed' %}{{ 'class="active"'}}{% endif %}><a href="/software-training/workshop/{{role}}/completed/">Completed</a></li>
        <li {% if status == 'reschedule' %}{{ 'class="active"'}}{% endif %}><a href="/software-training/workshop/{{role}}/reschedule/">Reschedule</a></li>
        <li {% if status == 'rejected' %}{{ 'class="active"'}}{% endif %}><a href="/software-training/workshop/{{role}}/rejected/">Rejected</a></li>
	</ul>
	<!-- Tab panes -->
	<div class="tab-content">
		<div class="tab-pane" id="new">
			<iframe width = "100%" src="/software-training/workshop/request/"></iframe> -->
		</div>
		<div class="tab-pane active" id="pending">
			{% if collection %}
			<table class="paleblue table table-striped table-hover table-bordered">
				{% get_sortable_header header ordering %}
				{% for record in collection %}
					<tr>
					    <td>{{ record.academic.state }}</td>
						<td>{{ record.academic }}</td>
						<td>{{ record.foss }}</td>
						<td>{{ record.language }}</td>
						<td>{{ record.wdate|date:"d M Y" }} {{	record.wtime }}</td>
						{% if status == 'completed' %}
						    <td>{{ record.participant_counts }}</td>
						{% endif %}
                        <!-- actions based on roles -->
                        <td>
                            {% if role == 'rp' %}
                                {% if status == 'pending' %}
                                    <a href="{% url 'events:workshop_edit' role record.id %}">Edit</a>
                                {% endif %}
                                {% if status == 'pending' %}
                                    <a href="{% url 'events:workshop_approvel' role record.id %}?status=accept">Accept</a>
                                    <a href="{% url 'events:workshop_approvel' role record.id %}?status=reject">Reject</a>
                                {% endif %}
                                {% if status == 'approved' %}
                                    <a href="{% url 'events:workshop_approvel' role record.id %}?status=reject">Reject</a>
                                {% endif %}
                                {% if status == 'reschedule' %}
                                    <a href="{% url 'events:workshop_edit' role record.id %}">Edit</a>
                                {% endif %}
                                {% if status == 'ongoing' %}
                                    <a href="{% url 'events:workshop_participant' record.id %}">Participants</a>
                                {% endif %}
                                {% if status == 'rejected' %}
                                    <a href="{% url 'events:workshop_approvel' role record.id %}?status=accept">Accept</a>
                                {% endif %}
                            {% endif %}
                            {% if role == 'organiser' %}
                                {% if status == 'reschedule' %}
                                    <a href="{% url 'events:workshop_edit' role record.id %}">Edit</a>
                                {% endif %}
                                {% if status == 'pending' %}
                                    <a href="{% url 'events:workshop_edit' role record.id %}">Edit</a>
                                {% endif %}
                                {% if status == 'approved' %}
                                    <a href="{% url 'events:workshop_participant' record.id %}">Participants</a>
                                {% endif %}
                                {% if status == 'ongoing' %}
                                    {% if record.id|can_upload_workshop_data:'workshop' %}
                                        <a href="{% url 'mdldjango:mdl_offline_workshop_details' record.id 1 %}">Upload data</a> |
                                    {% endif %}
                                    <a href="{% url 'events:workshop_attendance' record.id %}">Attendance</a> |
                                    <a href="{% url 'events:workshop_participant' record.id %}">Participants</a>
                                {% endif %}
                            {% endif %}
                            {% if status == 'completed' %}
                                <a href="{% url 'events:workshop_participant' record.id %}">View Participants</a>
                            {% endif %}
						</td>
					</tr>
                   {% endfor %}
                </table>
			{% else %}
				<p class='no-record'>No record found!</p>
			{% endif %}
		</div>
	</div>
{% endblock %}
