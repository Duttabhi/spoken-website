{% extends 'spoken/templates/base.html' %}
{% load widget_tweaks %}
{% load static %}
{% block title %}Upload Tutorial{% endblock %}
{% block cssblock %}<link rel="stylesheet" href="{% static 'spoken/css/chosen.min.css' %}" type="text/css" media="screen" charset="utf-8" />{% endblock %}
{% block content %}
	<form action="{{ action }}" method="post">{% csrf_token %}
		{% with WIDGET_ERROR_CLASS='field-error' WIDGET_REQUIRED_CLASS='field-required' %}
			{% if form.non_field_errors %}
			<ul>
			  {% for error in form.non_field_errors %}
				<li>{{ error }}</li>
			  {% endfor %}
			</ul>
			{% endif %}
			{% if edit %}
				<h3 class="form-signin-heading">Edit Organiser</h3>
			{% else %}
				<h3 class="form-signin-heading">Add Organiser</h3>
			{% endif %}
	
			<div class="form-group">
				<label for="id_state">State</label>
				{% render_field form.state class+="form-control chosen state" tabindex="1" data-placeholder="Choose State" %}
				{{ form.state.errors }}
			</div>
			<div class="form-group">
				<label for="id_district">District</label>
				{% render_field form.district class+="form-control chosen district" tabindex="1" data-placeholder="Choose district" %}
				{{ form.district.errors }}
			</div>
			<div class="form-group">
				<label for="id_college">Institution</label>
				{% render_field form.college class+="form-control chosen college" tabindex="1" data-placeholder="Choose Institution" %}
				{{ form.college.errors }}
			</div>
	
			<input class="btn btn-primary" type="submit" value="Submit" />
		{% endwith %}
</form>
{% endblock %}

{% block jsblock %}
<script>
	$(document).ready(function(){
		$acstate = $('.state');
		$ac_district = $(".district");
		$college = $(".college");
		
		$acstate.change(function() {
			var state = $(this).val();
			$.ajax({
				url: "/events/ajax-ac-state/",
				type: "POST",
				data: {
					state: state,
					fields: {'district':'district'},
				},
				success: function(data) {
					if(data.district){
						$ac_district.html(data.district);
						$ac_district.trigger("chosen:updated");
						$ac_district.removeAttr("disabled");
					}else{
						$ac_district.html('<option>-- None -- </option>')
						$ac_district.trigger("chosen:updated");
						$ac_district.attr("disabled", "disabled");
						alert('No District found for this State!!');
					}
					//console.log("District = " + data[1]);
				}
			});
		});
		
		$ac_district.change(function() {
			var district = $(this).val();
			$.ajax({
				url: "/events/ajax-district-collage/",
				type: "POST",
				data: {
					district : district
				},
				success: function(data) {
					if(data){
						$college.html(data);
						$college.removeAttr("disabled");
					} else{
						$college.attr("disabled", "disabled");
						alert('No college found for this district!!');
					}
				}
			});
		});
	});
</script>
{% endblock %}

